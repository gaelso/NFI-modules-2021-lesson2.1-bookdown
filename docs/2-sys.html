<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Systematic sampling | NFI eLearning Practice Module</title>
  <meta name="description" content="2 Systematic sampling | NFI eLearning Practice Module" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Systematic sampling | NFI eLearning Practice Module" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Systematic sampling | NFI eLearning Practice Module" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1-size.html"/>
<link rel="next" href="3-sys3.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html"><b>NFI eLearning Practice L2.1</b></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-size.html"><a href="1-size.html"><i class="fa fa-check"></i><b>1</b> Sampling size</a></li>
<li class="chapter" data-level="2" data-path="2-sys.html"><a href="2-sys.html"><i class="fa fa-check"></i><b>2</b> Systematic sampling</a>
<ul>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#grid-spacing"><i class="fa fa-check"></i>Grid spacing</a></li>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#create-grid-points"><i class="fa fa-check"></i>Create grid points</a>
<ul>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#how-to-create-grids"><i class="fa fa-check"></i>How to create grids</a></li>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#how-to-create-aligned-sampling-points"><i class="fa fa-check"></i>How to create aligned sampling points</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#calculate-the-number-of-plots-per-land-cover-class"><i class="fa fa-check"></i>Calculate the number of plots per land cover class</a></li>
<li class="chapter" data-level="" data-path="2-sys.html"><a href="2-sys.html#systematic-sampling-recap"><i class="fa fa-check"></i>Systematic sampling: Recap</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-sys3.html"><a href="3-sys3.html"><i class="fa fa-check"></i><b>3</b> Systematic sampling: 3 x 3 km grid</a></li>
<li class="chapter" data-level="4" data-path="4-ran.html"><a href="4-ran.html"><i class="fa fa-check"></i><b>4</b> Random Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="4-ran.html"><a href="4-ran.html#demo"><i class="fa fa-check"></i>Demo</a></li>
<li class="chapter" data-level="" data-path="4-ran.html"><a href="4-ran.html#practice"><i class="fa fa-check"></i>Practice</a></li>
<li class="chapter" data-level="" data-path="4-ran.html"><a href="4-ran.html#proportion-of-plots-per-forest-type"><i class="fa fa-check"></i>Proportion of plots per forest type</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://bit.ly/3m5VEsE" target="blank"><b>NFI eLearning modules</b></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NFI eLearning Practice Module</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sys" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Systematic sampling</h1>
<p>Now let’s see what sampling grid spacing is the closest to a sampling size of 281 plots, the number of plots selected with our budget constraint. We will start with <txt-green>systematic sampling</txt-green> to account for the additional constraint on grid spacing, and afterwards we will make a simple random sampling that matches the same number of plots.</p>
<p> </p>
<div id="grid-spacing" class="section level2 unnumbered">
<h2>Grid spacing</h2>
<p>To calculate the grid spacing that corresponds to our sampling size, we must first divide forest area by sampling size to obtain an estimate of the area that each sample point represents. For a square grid, the square root of this division gives the grid spacing. For example, for a 1,000 ha forest and a sampling size of 20 plots, the grid size will be:</p>
<p><span class="math display">\[d = \sqrt{\frac{1000 ha}{20}} = \sqrt{50ha} = \sqrt{500000m^2} \approx 707.1m\]</span></p>
<p>In our case, we can calculate the forest area of Louland from the table, <code>area_lc</code>, calculated in Lesson 1. We need to (1) filter forested land cover classes with the function <code>filter()</code>, (2) extract their area with the function <code>pull()</code> and (3) sum their area.</p>
<p><strong>Your turn! Use the console below to create the object, <code>area_forest</code>, which contains the total forest area.</strong></p>
<p>Remember that our land cover classes are coded <code>EV</code>, <code>MD</code>, <code>DD</code>, <code>MG</code>, <code>WL</code>, <code>NF</code> and <code>WA</code> for Evergreen, Mixed Deciduous, Deciduous and Mangrove Forests, Woodland, Non-Forest and Water respectively.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb16-1"><a href="2-sys.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb16-2"><a href="2-sys.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb17-1"><a href="2-sys.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb17-2"><a href="2-sys.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">## First run `area_lc` in the console to see what land cover classes are represented and which codes need to be filtered</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb18-1"><a href="2-sys.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb18-2"><a href="2-sys.html#cb18-2" aria-hidden="true" tabindex="-1"></a>area_forest <span class="ot">&lt;-</span> area_lc <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="2-sys.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(___)) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="2-sys.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="2-sys.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb18-6"><a href="2-sys.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="2-sys.html#cb18-7" aria-hidden="true" tabindex="-1"></a>area_forest</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb19-1"><a href="2-sys.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb19-2"><a href="2-sys.html#cb19-2" aria-hidden="true" tabindex="-1"></a>area_forest <span class="ot">&lt;-</span> area_lc <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="2-sys.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;EV&quot;</span>, <span class="st">&quot;MD&quot;</span>, <span class="st">&quot;DD&quot;</span>, <span class="st">&quot;MG&quot;</span>, <span class="st">&quot;WL&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="2-sys.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(area_ha) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="2-sys.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb19-6"><a href="2-sys.html#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="2-sys.html#cb19-7" aria-hidden="true" tabindex="-1"></a>area_forest</span></code></pre></div>
<pre class="Rout-sol"><code>502340.1 [ha]</code></pre>
<p> </p>
<p>Then we need to convert the forest area from hectares to square km:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="2-sys.html#cb21-1" aria-hidden="true" tabindex="-1"></a>area_forest_km2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">set_units</span>(area_forest, <span class="at">value =</span> km2))</span>
<span id="cb21-2"><a href="2-sys.html#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="2-sys.html#cb21-3" aria-hidden="true" tabindex="-1"></a>area_forest_km2 </span></code></pre></div>
<pre class="Rout-demo"><code>[1] 5023.401</code></pre>
<p>Finally, we can apply the grid spacing formula with the square root function <code>sqrt()</code>, and the sampling size for a 10% precision, <code>n10</code>. Complete the following code sequence to calculate the grid spacing.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb23-1"><a href="2-sys.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb23-2"><a href="2-sys.html#cb23-2" aria-hidden="true" tabindex="-1"></a>grid_spacing <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(___ <span class="sc">/</span> ___), <span class="dv">3</span>)</span>
<span id="cb23-3"><a href="2-sys.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="2-sys.html#cb23-4" aria-hidden="true" tabindex="-1"></a>grid_spacing</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb24-1"><a href="2-sys.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb24-2"><a href="2-sys.html#cb24-2" aria-hidden="true" tabindex="-1"></a>grid_spacing <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(area_forest_km2 <span class="sc">/</span> n10), <span class="dv">3</span>)</span>
<span id="cb24-3"><a href="2-sys.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="2-sys.html#cb24-4" aria-hidden="true" tabindex="-1"></a>grid_spacing</span></code></pre></div>
<pre class="Rout-sol"><code>[1] 4.228</code></pre>
<p>The result is a grid spacing slightly larger than 4km. We must note here that the number of plots falling on forest land might differ from this hypothetical value, depending on the forest distribution. We need to create the grid and calculate how many plots are located on forest land in order to cross check that the grid spacing fits our desired cost/precision sampling size. Even after this confirmation, there can be mapping errors and several plots confirmed to be located on forest land that may not be actually forested.</p>
<p> </p>
<div class="infobox">
<p>To help you become familiar with the R code, we will demonstrate the sequence of commands to create the grid, map it and calculate the number of plots per land cover class on a 5 x 5 km grid and we will let you develop the 4 x 4 km grid through guided exercises.</p>
</div>
<p> </p>
</div>
<div id="create-grid-points" class="section level2 unnumbered">
<h2>Create grid points</h2>
<p>The <code>sf</code> package contains the function <code>st_make_grid()</code> to create grids, and aligned or unaligned grid points within grid polygons. We have the <code>sf_admin</code> shapefile that contains the administrative boundary of Louland and can be used as a canvas for the grid.</p>
<p>We have two <code>sf</code> objects in the preliminary data: <code>sf_admin</code>, the administrative boundaries of Louland and <code>sf_lc</code> the land cover shapefile data of Louland. In the console below you can run the object names to see their basic information.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="2-sys.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb26-2"><a href="2-sys.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<p> </p>
<div class="infobox">
<p>By default, the grid starting point is the land most Southern and Western point. Systematic sampling designs are considered to be random samples of size one as only the starting point of their grid is chosen randomly. To get a random starting point so, we will chose randomly an integer value between 500 meters and 2 km. We start at 500m to avoid having too many plots at the edge of the land. This is a precaution specific for this exercise, as <code>Louland</code>’s shape is close to a square. This precaution may not be needed in a real country! The <code>offset</code> is calculated based on the land cover shapefile bounding box calculated with <code>st_bbox()</code>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="2-sys.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb27-2"><a href="2-sys.html#cb27-2" aria-hidden="true" tabindex="-1"></a>random_x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">500</span><span class="sc">:</span><span class="dv">2000</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb27-3"><a href="2-sys.html#cb27-3" aria-hidden="true" tabindex="-1"></a>random_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">500</span><span class="sc">:</span><span class="dv">2000</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb27-4"><a href="2-sys.html#cb27-4" aria-hidden="true" tabindex="-1"></a>offset <span class="ot">&lt;-</span> <span class="fu">st_bbox</span>(sf_lc)[<span class="fu">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;ymin&quot;</span>)] <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>random_x, <span class="sc">-</span>random_y)</span></code></pre></div>
</div>
<p> </p>
<div id="how-to-create-grids" class="section level3 unnumbered">
<h3>How to create grids</h3>
<p>To create a 5 x 5 km grid, we will fill the input <code>cellsize</code> with <code>c(5000, 5000)</code> as the unit is meters, and to make the grid we use the option <code>what = "polygon"</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="2-sys.html#cb28-1" aria-hidden="true" tabindex="-1"></a>sf_grid5 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">5000</span>), <span class="at">what =</span> <span class="st">&quot;polygons&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="2-sys.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="2-sys.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
<p><strong>Your turn! Adapt the above code to create <code>sf_grid4</code>, the 4 x 4 km grid.</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb29-1"><a href="2-sys.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb29-2"><a href="2-sys.html#cb29-2" aria-hidden="true" tabindex="-1"></a>sf_grid4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(___, ___), <span class="at">what =</span> ___, <span class="at">offset =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="2-sys.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="2-sys.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb30-1"><a href="2-sys.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb30-2"><a href="2-sys.html#cb30-2" aria-hidden="true" tabindex="-1"></a>sf_grid4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">4000</span>), <span class="at">what =</span> <span class="st">&quot;polygons&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="2-sys.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="2-sys.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
</div>
<div id="how-to-create-aligned-sampling-points" class="section level3 unnumbered">
<h3>How to create aligned sampling points</h3>
<p>To create the points, we change the option to <code>what = "center"</code> (replace <code>"center"</code> with <code>"corner"</code> to locate the points at the grid intersections). At this stage, we can also use the function <code>st_intersection()</code> to reduce the grid to our ‘country’ boundaries and the function <code>st_as_sf()</code> converts the result of the intersection to an <code>sf</code> object.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="2-sys.html#cb31-1" aria-hidden="true" tabindex="-1"></a>sf_points5 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">5000</span>), <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="2-sys.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="2-sys.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
<p><strong>Your turn! Prepare <code>sf_point4</code>, the points’ location on the 4 x 4 k grid.</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb32-1"><a href="2-sys.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb32-2"><a href="2-sys.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb33-1"><a href="2-sys.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb33-2"><a href="2-sys.html#cb33-2" aria-hidden="true" tabindex="-1"></a>sf_points4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(___, ___), <span class="at">what =</span> ___, <span class="at">offset =</span> ___) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="2-sys.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="2-sys.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb34-1"><a href="2-sys.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb34-2"><a href="2-sys.html#cb34-2" aria-hidden="true" tabindex="-1"></a>sf_points4 <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(sf_lc, <span class="at">cellsize =</span> <span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">4000</span>), <span class="at">what =</span> <span class="st">&quot;centers&quot;</span>, <span class="at">offset =</span> offset) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="2-sys.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_intersection</span>(sf_admin) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="2-sys.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code></pre></div>
<p> </p>
<p>We can finally overlap the grid points with the land cover layer, using the function <code>st_join()</code>, to assign land cover to each plot. We aim for our land cover code <code>lc</code> to appear in a certain order in the map. To follow the order of the land cover numerical ID <code>lc_id</code>, we use the function <code>fct_reorder()</code> from the tidyverse package <code>forcats</code>. This function converts a text variable into an ordered factor following an other variable (in our case <code>lc_id</code>).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="2-sys.html#cb35-1" aria-hidden="true" tabindex="-1"></a>sf_plot5 <span class="ot">&lt;-</span> sf_points5 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="2-sys.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="2-sys.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="2-sys.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p> </p>
<p><strong>Your turn! Adapt the above code to prepare <code>sf_plot4</code>, joining the points location and the land cover class spatial data.</strong></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb36-1"><a href="2-sys.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb36-2"><a href="2-sys.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb37-1"><a href="2-sys.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb37-2"><a href="2-sys.html#cb37-2" aria-hidden="true" tabindex="-1"></a>sf_plot4 <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="2-sys.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(___) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="2-sys.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(___, ___)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="2-sys.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(___)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb38-1"><a href="2-sys.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb38-2"><a href="2-sys.html#cb38-2" aria-hidden="true" tabindex="-1"></a>sf_plot4 <span class="ot">&lt;-</span> sf_points4 <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="2-sys.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_join</span>(sf_lc) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="2-sys.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lc =</span> <span class="fu">fct_reorder</span>(lc, lc_id)) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="2-sys.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lc))</span></code></pre></div>
<p> </p>
</div>
</div>
<div id="visualize" class="section level2 unnumbered">
<h2>Visualize</h2>
<p>We can visualize the grid with the following code based on the <code>ggplot2</code> package and its <code>geom_sf()</code> function to display <code>sf</code> objects.</p>
<p> </p>
<div class="infobox">
<p>We have a custom color palette <code>pal</code> for <code>Louland</code> land covers. We can see this color palette with the function <code>show_col()</code>, from the <code>scales</code> package</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="2-sys.html#cb39-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#73c2fb&quot;</span>, <span class="st">&quot;#edf5e1&quot;</span>, <span class="st">&quot;#ffcb9a&quot;</span>, <span class="st">&quot;#5cdb95&quot;</span>, <span class="st">&quot;#379683&quot;</span>, <span class="st">&quot;#00743f&quot;</span>, <span class="st">&quot;#012172&quot;</span>)</span>
<span id="cb39-2"><a href="2-sys.html#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="2-sys.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb39-4"><a href="2-sys.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">show_col</span>(pal)</span></code></pre></div>
<p><img src="Handbook_files/figure-html/pal-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<p> </p>
<p>Here is the code to make the map with the 5 x 5 km systematic sampling design.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="2-sys.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb40-2"><a href="2-sys.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="2-sys.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot5, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb40-4"><a href="2-sys.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_grid5, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="2-sys.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_admin, <span class="at">fill=</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="2-sys.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb40-7"><a href="2-sys.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="2-sys.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/ggplot5-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
<p><strong>It’s looking good! Adapt this code to make the same map with the 4 x 4 km grid.</strong></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb41-1"><a href="2-sys.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb41-2"><a href="2-sys.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb42-1"><a href="2-sys.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb42-2"><a href="2-sys.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="2-sys.html#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ___, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="2-sys.html#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ___, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="2-sys.html#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ___, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="2-sys.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> ___, <span class="at">fill=</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb42-7"><a href="2-sys.html#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> ___) <span class="sc">+</span></span>
<span id="cb42-8"><a href="2-sys.html#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb42-9"><a href="2-sys.html#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb43-1"><a href="2-sys.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb43-2"><a href="2-sys.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="2-sys.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_lc, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="2-sys.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_plot4, <span class="fu">aes</span>(<span class="at">fill =</span> lc), <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb43-5"><a href="2-sys.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_grid4, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="2-sys.html#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> sf_admin, <span class="at">fill=</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="2-sys.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb43-8"><a href="2-sys.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;&quot;</span>, <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="2-sys.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="Handbook_files/figure-html/ggplot4-sol-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p> </p>
</div>
<div id="calculate-the-number-of-plots-per-land-cover-class" class="section level2 unnumbered">
<h2>Calculate the number of plots per land cover class</h2>
<p>To calculate the number of plots in each land cover class, we need to group the plots by land cover with the function <code>group_by()</code>, then count them with the function <code>summarise()</code> (remember lesson 1) and the function <code>n()</code>. The function <code>n()</code> counts the number of rows in a table or in each category of a category variable. As we don’t need the spatial information, we first convert our <code>sf</code> object to a tibble with the function <code>as_tibble()</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="2-sys.html#cb44-1" aria-hidden="true" tabindex="-1"></a>nplot5 <span class="ot">&lt;-</span> sf_plot5 <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="2-sys.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="2-sys.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="2-sys.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb44-5"><a href="2-sys.html#cb44-5" aria-hidden="true" tabindex="-1"></a>nplot5 </span></code></pre></div>
<pre class="Rout-demo"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        2
2 NF       63
3 WL       62
4 DD       23
5 MD       73
6 EV       40
7 MG        4</code></pre>
<p> </p>
<p><strong>Your turn! Calculate the number of plots per land cover class with the 4 x 4 km grid</strong></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb46-1"><a href="2-sys.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb46-2"><a href="2-sys.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb47-1"><a href="2-sys.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb47-2"><a href="2-sys.html#cb47-2" aria-hidden="true" tabindex="-1"></a>nplot4 <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="2-sys.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="2-sys.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">___</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="2-sys.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">___</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb47-6"><a href="2-sys.html#cb47-6" aria-hidden="true" tabindex="-1"></a>nplot4 </span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb48-1"><a href="2-sys.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb48-2"><a href="2-sys.html#cb48-2" aria-hidden="true" tabindex="-1"></a>nplot4 <span class="ot">&lt;-</span> sf_plot4 <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="2-sys.html#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="2-sys.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lc) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="2-sys.html#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb48-6"><a href="2-sys.html#cb48-6" aria-hidden="true" tabindex="-1"></a>nplot4 </span></code></pre></div>
<pre class="Rout-sol"><code># A tibble: 7 x 2
  lc        n
  &lt;fct&gt; &lt;int&gt;
1 WA        2
2 NF      101
3 WL       92
4 DD       41
5 MD      123
6 EV       54
7 MG        8</code></pre>
<p> </p>
<p>Last step, to get the total number of forest plots, we need to filter out non-forest categories with the function <code>filter()</code> and sum up the remaining number of plots.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="2-sys.html#cb50-1" aria-hidden="true" tabindex="-1"></a>nplot5_total <span class="ot">&lt;-</span> nplot5 <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="2-sys.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="2-sys.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb50-4"><a href="2-sys.html#cb50-4" aria-hidden="true" tabindex="-1"></a>nplot5_total</span></code></pre></div>
<pre class="Rout-demo"><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1   202</code></pre>
<p> </p>
<p><strong>Your turn! Calculate the total number of forest plots in the 4 x 4 km grid.</strong></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb52-1"><a href="2-sys.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Console</span></span>
<span id="cb52-2"><a href="2-sys.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r Rchunk-cons"><code class="sourceCode r"><span id="cb53-1"><a href="2-sys.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Tips</span></span>
<span id="cb53-2"><a href="2-sys.html#cb53-2" aria-hidden="true" tabindex="-1"></a>nplot4_total <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="2-sys.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="2-sys.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(___)</span>
<span id="cb53-5"><a href="2-sys.html#cb53-5" aria-hidden="true" tabindex="-1"></a>nplot4_total</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r Rchunk-sol"><code class="sourceCode r"><span id="cb54-1"><a href="2-sys.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Solution</span></span>
<span id="cb54-2"><a href="2-sys.html#cb54-2" aria-hidden="true" tabindex="-1"></a>nplot4_total <span class="ot">&lt;-</span> nplot4 <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="2-sys.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(lc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;WA&quot;</span>, <span class="st">&quot;NF&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="2-sys.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb54-5"><a href="2-sys.html#cb54-5" aria-hidden="true" tabindex="-1"></a>nplot4_total</span></code></pre></div>
<pre class="Rout-sol"><code># A tibble: 1 x 1
      n
  &lt;int&gt;
1   318</code></pre>
<p> </p>
<p>Good job! Looking back at the sampling size given by different precision levels, we had <code>281</code> plots for 10% precision and <code>125</code> plots for 15% precision. Our budget is enough to measure around 300 plots, so we can afford an expected precision of 10%. <txt-green>The 4 x 4 km grid</txt-green> anticipates 318 plots in forest land and its exactly what we need and can afford.</p>
<p> </p>
</div>
<div id="systematic-sampling-recap" class="section level2 unnumbered">
<h2>Systematic sampling: Recap</h2>
<p>Based on the preliminary inventory, and analysing using R skills, we have now identified a good sampling grid. To recap, the process was:</p>
<ol style="list-style-type: decimal">
<li>We used the <strong>preliminary forest inventory</strong> results to calculate a hypothetical number of samples required for a desired precision of 5, 10, 15 or 20%.</li>
<li>Based on our available budget we have identified what precision we can afford and how many plots it requires, <em>i.e.</em> our <strong>sampling size</strong>.</li>
<li>We have then created different <strong>sampling grids</strong> for Louland and estimated how many plots would fall on forest land.</li>
<li>We have selected the most adequate sampling grid based on our <strong>cost/precision trade-off</strong>.</li>
</ol>

<div style="page-break-after: always;"></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1-size.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-sys3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
